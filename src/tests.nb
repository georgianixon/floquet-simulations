(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84103,       2283]
NotebookOptionsPosition[     79780,       2202]
NotebookOutlinePosition[     80123,       2217]
CellTagsIndexPosition[     80080,       2214]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H0", "[", "Nl_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "\[IndentingNewLine]", "0"}], "]"}], ",",
      " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vt", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "t_", ",", " ", "\[Phi]_"}], "]"}], ":=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[Equal]", "j"}], " ", "&&", 
        RowBox[{"i", " ", "\[Equal]", " ", "centre"}]}], ",", " ", 
       RowBox[{"A", "*", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "*", "t"}], " ", "+", " ", "\[Phi]"}], "]"}]}], 
       ",", " ", "0"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vt", "[", 
   RowBox[{
   "7", ",", "4", ",", "A", ",", " ", "\[Omega]", ",", " ", "t", ",", " ", 
    "\[Phi]"}], "]"}], " ", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Ht", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "t_", ",", " ", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H0", "[", "Nl", "]"}], " ", "+", " ", 
    RowBox[{"Vt", "[", 
     RowBox[{
     "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", 
      "t", ",", " ", "\[Phi]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ht", "[", 
   RowBox[{
   "7", ",", " ", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", "t", 
    ",", " ", "\[Phi]"}], "]"}], " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8312036022332945`*^9, 3.8312036152566032`*^9}, {
  3.831203665340353*^9, 3.8312037107982574`*^9}, {3.831203742445984*^9, 
  3.8312038516628656`*^9}, {3.832349522770157*^9, 3.832349544106608*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9fd9db2e-4768-423d-8417-d2e06e841bcb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"A", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "+", 
         RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831203853220868*^9, {3.8312074706887026`*^9, 3.831207498580627*^9}, 
   3.832342950944446*^9, 3.832349544800523*^9, 3.8328429916859827`*^9},
 CellLabel->
  "Out[3]//MatrixForm=",ExpressionUUID->"4fa16113-f72f-4a25-bba7-\
aab7fc1933c4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"A", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]", "+", 
         RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831203853220868*^9, {3.8312074706887026`*^9, 3.831207498580627*^9}, 
   3.832342950944446*^9, 3.832349544800523*^9, 3.8328429916930485`*^9},
 CellLabel->
  "Out[5]//MatrixForm=",ExpressionUUID->"f4b7fdaa-2982-4dcd-9f88-\
e6f7c248ecf5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R1", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "t_", ",", " ", "\[Phi]_"}], "]"}], " ", ":=", 
   RowBox[{"MatrixExp", "[", 
    RowBox[{
     RowBox[{"-", "\[ImaginaryI]"}], "*", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Vt", "[", 
        RowBox[{
        "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",", 
         " ", "tt", ",", " ", "\[Phi]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"tt", ",", " ", "0", ",", " ", "t"}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", "[", 
   RowBox[{
   "7", ",", "4", ",", "A", ",", " ", "\[Omega]", ",", " ", "t", ",", " ", 
    "\[Phi]"}], "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.831208018919093*^9, 3.8312080265061913`*^9}, {
  3.831208067690482*^9, 3.831208084699856*^9}, {3.8312081229307923`*^9, 
  3.831208268217445*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"dfe7f672-3734-4649-ba56-d5c86249c702"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "A", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Phi]", "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], "\[Omega]"]],
       "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312082686831636`*^9, {3.8323429481847754`*^9, 3.8323429532975664`*^9}, 
   3.8328429958120365`*^9},
 CellLabel->
  "Out[7]//MatrixForm=",ExpressionUUID->"15cc3554-093c-466c-8518-\
15871ae33556"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Gauge", " ", "transform", " ", "into", " ", "lattice", " ", "frame"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HTilde1", "[", 
      RowBox[{
      "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
       " ", "t_", ",", " ", "\[Phi]_"}], "]"}], ":=", " ", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"R1", "[", 
           RowBox[{
           "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",",
             " ", "t", ",", " ", "\[Phi]"}], "]"}], "]"}], ".", 
         RowBox[{"Ht", "[", 
          RowBox[{
          "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",", 
           " ", "t", ",", " ", "\[Phi]"}], "]"}], ".", 
         RowBox[{"R1", "[", 
          RowBox[{
          "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",", 
           " ", "t", ",", " ", "\[Phi]"}], "]"}]}], " ", "-", " ", 
        RowBox[{"\[ImaginaryI]", "*", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", 
           RowBox[{"R1", "[", 
            RowBox[{
            "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", 
             ",", " ", "t", ",", " ", "\[Phi]"}], "]"}], "]"}], ".", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"R1", "[", 
             RowBox[{
             "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", 
              ",", " ", "t", ",", " ", "\[Phi]"}], "]"}], ",", "t"}], 
           "]"}]}]}]}], ",", " ", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{
         RowBox[{"A", " ", "\[Element]", " ", "Reals"}], "  ", "&&", " ", 
         RowBox[{"\[Omega]", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
         RowBox[{"\[Phi]", " ", "\[Element]", " ", "Reals"}], "&&", " ", 
         RowBox[{"t", "\[Element]", "Reals"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HTilde1", "[", 
     RowBox[{
     "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "t", ",", "\[Phi]"}], 
     "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.831208698017416*^9, 3.8312087359115562`*^9}, {
  3.831208809880935*^9, 3.831208817192734*^9}, {3.8323488173243465`*^9, 
  3.8323488266239233`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"27f3079f-ecb2-4494-98f4-178f8a6698ab"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sin", "[", "\[Phi]", "]"}], "-", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312087791216526`*^9, {3.831208812984137*^9, 3.831208817666439*^9}, {
   3.8323429431426764`*^9, 3.8323429562967196`*^9}, 3.8323488439035463`*^9, 
   3.8328429979837036`*^9},
 CellLabel->
  "Out[9]//MatrixForm=",ExpressionUUID->"83ff7c92-8933-4782-ba3c-\
cee938e9aecf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "ease", " ", "of", " ", "calculation"}], ",", " ", 
    RowBox[{"write", " ", "HTilde", " ", "explicitly"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HTilde", "[", 
      RowBox[{
      "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
       " ", "t_", ",", " ", "\[Phi]_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"i", "\[Equal]", "centre"}]}], "  ", ",", " ", 
         RowBox[{"-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"\[ImaginaryI]", "*", "A"}], "\[Omega]"], "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "*", "t"}], " ", "+", " ", "\[Phi]"}], 
               "]"}], " ", "-", " ", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], "]"}]}], ",", 
         " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
            RowBox[{"j", "\[Equal]", "centre"}]}], " ", ",", " ", 
           RowBox[{"-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              FractionBox[
               RowBox[{
                RowBox[{"-", "\[ImaginaryI]"}], "*", "A"}], "\[Omega]"], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", "*", "t"}], " ", "+", " ", "\[Phi]"}], 
                 "]"}], " ", "-", " ", 
                RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ")"}]}], "]"}]}], ",", 
           " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0"}], "]"}]}], "]"}]}], "]"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HTilde", "[", 
     RowBox[{
     "7", ",", " ", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", "t", 
      ",", " ", "\[Phi]"}], "]"}], "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.831203879743425*^9, 3.8312039571907644`*^9}, {
   3.831204039622176*^9, 3.8312040505499973`*^9}, {3.8312040825499687`*^9, 
   3.8312042063740935`*^9}, {3.831204238492901*^9, 3.8312042388680005`*^9}, {
   3.8312042900318003`*^9, 3.831204452977928*^9}, {3.8312050832311945`*^9, 
   3.831205099601575*^9}, {3.8312054489974527`*^9, 3.831205455117763*^9}, {
   3.8312088290469*^9, 3.8312088437764125`*^9}, {3.8312088915984554`*^9, 
   3.8312089038127675`*^9}, {3.8314666799349766`*^9, 3.831466703550394*^9}, 
   3.8323429979932365`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"a5a770f8-1436-40e5-919a-de0d2be7be19"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]", "+", 
               RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
          "\[Omega]"]}]]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
         "\[Omega]"]]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]", "+", 
               RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], ")"}]}], 
          "\[Omega]"]}]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8314667056781673`*^9, {3.832342979338393*^9, 3.8323429996370487`*^9}, 
   3.8328429998836985`*^9},
 CellLabel->
  "Out[11]//MatrixForm=",ExpressionUUID->"ad07f0a9-b429-4028-87bd-\
b11747450dc3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "the", " ", "first", " ", "term", " ", "of", " ", "the", 
    " ", "Magnus", " ", "expansion", " ", "in", " ", "this", " ", "Gauge"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    FractionBox["\[Omega]", 
     RowBox[{"2", "*", "\[Pi]"}]], 
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"HTilde", "[", 
         RowBox[{
         "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "tt", ",", "\[Phi]"}],
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"tt", ",", " ", "0", ",", " ", 
          FractionBox[
           RowBox[{"2", "*", "\[Pi]"}], "\[Omega]"]}], "}"}]}], "]"}], ",", 
      " ", 
      RowBox[{"Assumptions", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"A", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
        RowBox[{
         FractionBox["1", "\[Omega]"], "\[Element]", " ", "Reals"}]}]}]}], 
     "]"}]}], " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.83234300559229*^9, 3.832343021614924*^9}, {
  3.832348865042056*^9, 3.832348870364643*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"e76434d2-83af-434c-87d6-a511344c5bd7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]}]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]}]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8323430495151014`*^9, 3.832348879921941*^9},
 CellLabel->
  "Out[36]//MatrixForm=",ExpressionUUID->"c2d729ab-6663-4076-9c61-\
4d096a60c4df"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"G1", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", " ", 
        RowBox[{"i", "\[Equal]", "centre"}]}], ",", " ", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{
            RowBox[{"-", "\[ImaginaryI]"}], "*", "A", "*", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"], "]"}]}], "*", 
        RowBox[{"BesselJ", "[", 
         RowBox[{"0", ",", " ", 
          FractionBox["A", "\[Omega]"]}], "]"}]}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"j", "\[Equal]", "centre"}]}], ",", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Exp", "[", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", "*", "A", "*", 
              RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"], "]"}]}], 
          "*", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"0", ",", 
            FractionBox["A", "\[Omega]"]}], "]"}]}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], ",", " ", 
           RowBox[{"-", "1"}], ",", " ", "0"}], "]"}]}], "]"}]}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G1", "[", 
   RowBox[{"7", ",", "4", ",", "A", ",", "\[Omega]", ",", "\[Phi]"}], "]"}], 
  " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.832843016689723*^9, 3.8328431941310296`*^9}, {
  3.832843958838072*^9, 3.832843972482913*^9}, {3.832845774487914*^9, 
  3.832845774808754*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"907d569a-d297-4cf2-910e-8f843dafcd1c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]}]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]}]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]]}], " ", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8328431956058702`*^9, 3.8328439732045565`*^9, 
  3.8328457759844513`*^9},
 CellLabel->
  "Out[41]//MatrixForm=",ExpressionUUID->"5dfd895f-e139-48c8-8b15-\
c6e2c7e56bd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nb", "[", 
    RowBox[{"Nl_", ",", "centre_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "\[Equal]", "centre"}], " ", "&&", 
        RowBox[{"j", "\[Equal]", "centre"}]}], ",", " ", "1", ",", " ", "0"}],
       "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "Nl"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "Nl"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nb", "[", 
   RowBox[{"7", ",", "4"}], "]"}], " ", "//", " ", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"TeXForm", "[", 
  RowBox[{"MatrixExp", "[", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", "\[Omega]"]}], "*", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "*", 
    RowBox[{"nb", "[", 
     RowBox[{"7", ",", "4"}], "]"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.832847278037112*^9, 3.832847373466139*^9}, {
  3.8328474036912217`*^9, 3.8328474494830766`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"4d23c2f0-7619-4258-9f9c-83488203b932"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8328473305581245`*^9, 3.8328473356510515`*^9}, {
  3.8328473695873003`*^9, 3.832847374041456*^9}, {3.8328474182092295`*^9, 
  3.8328474512159863`*^9}},
 CellLabel->
  "Out[68]//MatrixForm=",ExpressionUUID->"36ad0fd5-35c1-4d12-9a24-\
4cdbdf9ed170"],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 1 & 0 & 0 & 0 & 0 & 0 & 0 \\\\
 0 & 1 & 0 & 0 & 0 & 0 & 0 \\\\
 0 & 0 & 1 & 0 & 0 & 0 & 0 \\\\
 0 & 0 & 0 & e^{-\\frac{i \\sin (\\phi )}{\\omega }} & 0 & 0 & 0 \\\\
 0 & 0 & 0 & 0 & 1 & 0 & 0 \\\\
 0 & 0 & 0 & 0 & 0 & 1 & 0 \\\\
 0 & 0 & 0 & 0 & 0 & 0 & 1 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{{3.8328473305581245`*^9, 3.8328473356510515`*^9}, {
  3.8328473695873003`*^9, 3.832847374041456*^9}, {3.8328474182092295`*^9, 
  3.8328474512221217`*^9}},
 CellLabel->
  "Out[69]//TeXForm=",ExpressionUUID->"489f7d94-ea94-415e-9ed7-b354679bb95e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"RR", " ", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "\[Phi]_"}], "]"}], ":=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "centre"}], " ", "&&", 
         RowBox[{"j", "\[Equal]", "centre"}]}], ")"}], ",", " ", 
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], "*", "A", "*", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"], "]"}], ",", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", " ", "1", ",", " ", "0"}], 
        "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR", "[", 
   RowBox[{
   "7", ",", " ", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", 
    "\[Phi]"}], "]"}], " ", "//", " ", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8312045261227837`*^9, 3.831204532953183*^9}, {
   3.8312045980404854`*^9, 3.831204606104106*^9}, {3.8312051604651012`*^9, 
   3.8312051791453094`*^9}, {3.831205240943782*^9, 3.8312053706798267`*^9}, {
   3.8312077412896333`*^9, 3.8312077546909103`*^9}, 3.8312078215173655`*^9, 
   3.8312089380038805`*^9, {3.832347809481711*^9, 3.832347824832616*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"27d34c60-695d-43f6-b524-59611c241aa0"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", "0"},
     {"0", "0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "\[Omega]"]}]], "0", "0", 
      "0"},
     {"0", "0", "0", "0", "1", "0", "0"},
     {"0", "0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312053717003856`*^9, {3.8312074943031025`*^9, 3.831207506467092*^9}, 
   3.83120775548542*^9, 3.8312078220320807`*^9, 3.83120893898691*^9, 
   3.831466711489831*^9, 3.8323432323285255`*^9, {3.8323478101045847`*^9, 
   3.8323478252535257`*^9}, 3.8328455859004545`*^9},
 CellLabel->
  "Out[30]//MatrixForm=",ExpressionUUID->"2b64dd2b-2cf3-4b51-930c-\
d158145a8cea"]
}, Open  ]],

Cell[BoxData["MatrixExp"], "Input",
 CellChangeTimes->{{3.8328467802608905`*^9, 
  3.832846782750059*^9}},ExpressionUUID->"f06cd6d5-5da8-4f1f-9ed9-\
5e183c769fbd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "New", " ", "Gauge", " ", "transformed", " ", "Hamiltonian", " ", 
    "HTilde"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"RR", "[", 
        RowBox[{
        "7", ",", "4", ",", "A", ",", " ", "\[Omega]", ",", " ", "\[Phi]"}], 
        "]"}], "]"}], ".", 
      RowBox[{"HTilde", "[", 
       RowBox[{
       "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "t", ",", "\[Phi]"}], 
       "]"}], ".", 
      RowBox[{"RR", "[", 
       RowBox[{
       "7", ",", "4", ",", "A", ",", " ", "\[Omega]", ",", " ", "\[Phi]"}], 
       "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"A", " ", "\[Element]", "Reals"}], " ", "&&", " ", 
       RowBox[{"\[Omega]", "\[Element]", "Reals"}], " ", "&&", " ", 
       RowBox[{"\[Phi]", "\[Element]", "Reals"}], " ", "&&", " ", 
       RowBox[{"t", " ", "\[Element]", " ", "Reals"}]}]}]}], "]"}], " ", "//",
    " ", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.831205404118793*^9, 3.831205425285425*^9}, {
   3.8312054681278343`*^9, 3.8312055289913054`*^9}, {3.831205576046287*^9, 
   3.831205577628503*^9}, {3.831205660277259*^9, 3.8312056897939806`*^9}, {
   3.8312072023973*^9, 3.8312072550541306`*^9}, {3.831207321176674*^9, 
   3.8312073368635874`*^9}, {3.8312073669902143`*^9, 
   3.8312073672700534`*^9}, {3.8312077935804644`*^9, 
   3.8312077984217005`*^9}, {3.8312090658535295`*^9, 3.831209090801133*^9}, 
   3.8323427563917956`*^9, {3.8328455324681997`*^9, 
   3.8328455355132456`*^9}},ExpressionUUID->"e3df5b7b-1d80-47af-bc1a-\
c7893c5d51be"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], "0",
       "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "+", 
            RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "+", 
            RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], "0", 
      "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.831205488862914*^9, 3.8312055294143343`*^9}, {
   3.831205578399125*^9, 3.8312055883184595`*^9}, {3.8312072369262447`*^9, 
   3.8312072561245008`*^9}, {3.831207323944078*^9, 3.831207337905963*^9}, 
   3.8312073683904066`*^9, 3.8312077607214155`*^9, {3.8312077992521954`*^9, 
   3.8312078248764277`*^9}, 3.8312089519952507`*^9, 3.8314667156354294`*^9, {
   3.832347815708116*^9, 3.832347827697941*^9}},
 CellLabel->
  "Out[33]//MatrixForm=",ExpressionUUID->"7baca02c-1b3f-4b0c-b042-\
b1057dee9700"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "simplicity"}], ",", " ", 
    RowBox[{"write", " ", "this", " ", "explicitly"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"HTilde2", "[", 
      RowBox[{
      "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
       " ", "t_", ",", "\[Phi]_"}], "]"}], ":=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
          RowBox[{"i", "\[Equal]", "centre"}]}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"Exp", "[", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", "*", "A", "*", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"\[Omega]", "*", "t"}], " ", "+", " ", "\[Phi]"}], 
              "]"}]}], "\[Omega]"], "]"}]}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
            RowBox[{"j", "\[Equal]", "centre"}]}], ",", 
           RowBox[{"-", 
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", "*", "A", "*", 
                RowBox[{"Sin", "[", 
                 RowBox[{
                  RowBox[{"\[Omega]", "*", "t"}], " ", "+", " ", "\[Phi]"}], 
                 "]"}]}], "\[Omega]"]}], "]"}]}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0"}], "]"}]}], "]"}]}], "]"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"HTilde2", "[", 
     RowBox[{
     "7", ",", " ", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", "t", 
      ",", " ", "\[Phi]"}], "]"}], "//", " ", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.831209101820801*^9, 3.831209350631405*^9}, {
  3.831209388278688*^9, 3.831209400790471*^9}, {3.831466730068125*^9, 
  3.831466755657379*^9}, {3.8328456023770933`*^9, 3.832845617773501*^9}, {
  3.8328457059736204`*^9, 3.8328457062744784`*^9}, {3.8328460429192877`*^9, 
  3.8328460562544503`*^9}},ExpressionUUID->"25e7161e-70d6-4680-a44b-\
9b2c9cf7ef5e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], "0",
       "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "+", 
            RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"\[ImaginaryI]", " ", "A", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]", "+", 
            RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], "0", 
      "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[ImaginaryI]", " ", "A", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]", "+", 
             RowBox[{"t", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8312093522964115`*^9, {3.831209390030664*^9, 3.831209401359135*^9}, 
   3.831466719504199*^9, 3.8314667570725474`*^9, 3.832169448958234*^9, 
   3.832342850454409*^9, {3.8328455993527517`*^9, 3.8328456180286317`*^9}, 
   3.8328457073648186`*^9},
 CellLabel->
  "Out[39]//MatrixForm=",ExpressionUUID->"6c6a6560-8478-4961-8c27-\
16cab1197fad"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"First", " ", "term", " ", "of", " ", "Magnus", " ", "expansion"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      FractionBox["\[Omega]", 
       RowBox[{"2", "*", "\[Pi]"}]], 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"HTilde2", "[", 
         RowBox[{
         "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "tt", ",", "\[Phi]"}],
          "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"tt", ",", " ", "0", ",", " ", 
          FractionBox[
           RowBox[{"2", "*", "\[Pi]"}], "\[Omega]"]}], "}"}]}], "]"}]}], ",", 
     " ", 
     RowBox[{"Assumptions", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"A", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
       RowBox[{
        FractionBox["1", "\[Omega]"], "\[Element]", " ", "Reals"}]}]}]}], 
    "]"}], " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.8323427677869034`*^9, 3.8323428437740784`*^9}, {
  3.8323429051440935`*^9, 3.832342913823013*^9}, {3.8323441884884343`*^9, 
  3.8323442013825765`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"eba8695d-a293-4b88-925d-28a1601b1ef3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.8323428447833767`*^9, 3.832342869270102*^9}, 
   3.832344207986941*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"9c286a5e-1b60-4b63-98d6-\
6a64e3c6c079"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Write", " ", "this", " ", "explicitly"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"G12", "[", 
      RowBox[{
      "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
       " ", "\[Phi]_"}], "]"}], ":=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", " ", 
          RowBox[{"i", "\[Equal]", "centre"}]}], ",", " ", 
         RowBox[{"-", 
          RowBox[{"BesselJ", "[", 
           RowBox[{"0", ",", " ", 
            FractionBox["A", "\[Omega]"]}], "]"}]}], ",", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], " ", "&&", 
            " ", 
            RowBox[{"j", "\[Equal]", "centre"}]}], ",", " ", 
           RowBox[{"-", 
            RowBox[{"BesselJ", "[", 
             RowBox[{"0", ",", 
              FractionBox["A", "\[Omega]"]}], "]"}]}], ",", " ", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"i", "-", "j"}], "]"}], "\[Equal]", "1"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", "0"}], "]"}]}], "]"}]}], "]"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "Nl"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"j", ",", " ", "1", ",", " ", "Nl"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"G12", "[", 
     RowBox[{"7", ",", "4", ",", "A", ",", "\[Omega]", ",", "\[Phi]"}], "]"}],
     " ", "//", " ", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"TeXForm", "[", 
    RowBox[{"G12", "[", 
     RowBox[{"7", ",", "4", ",", "A", ",", "\[Omega]", ",", "\[Phi]"}], "]"}],
     "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8328457406496916`*^9, 3.8328458272260675`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"fa72ba26-e5e2-4727-906e-b4e9b4157d10"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.832845788022868*^9, 3.832845827643794*^9}},
 CellLabel->
  "Out[47]//MatrixForm=",ExpressionUUID->"05a99f74-1b52-4eaf-be96-\
3e0a1e76d9ff"],

Cell["\<\
\\left(
\\begin{array}{ccccccc}
 0 & -1 & 0 & 0 & 0 & 0 & 0 \\\\
 -1 & 0 & -1 & 0 & 0 & 0 & 0 \\\\
 0 & -1 & 0 & -J_0\\left(\\frac{A}{\\omega }\\right) & 0 & 0 & 0 \\\\
 0 & 0 & -J_0\\left(\\frac{A}{\\omega }\\right) & 0 & \
-J_0\\left(\\frac{A}{\\omega }\\right) & 0 & 0 \\\\
 0 & 0 & 0 & -J_0\\left(\\frac{A}{\\omega }\\right) & 0 & -1 & 0 \\\\
 0 & 0 & 0 & 0 & -1 & 0 & -1 \\\\
 0 & 0 & 0 & 0 & 0 & -1 & 0 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{{3.832845788022868*^9, 3.8328458276607943`*^9}},
 CellLabel->
  "Out[48]//TeXForm=",ExpressionUUID->"3727dda5-39df-469f-9d57-cc4799dcd3dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Can", " ", "we", " ", "transform", " ", "Gauge1", " ", "first", " ", 
    "term", " ", "of", " ", "Magnus", " ", "Expansion", " ", "in", " ", "to", 
    " ", "Gauge", " ", "2", " ", "first", " ", 
    RowBox[{"term", "?"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ConjugateTranspose", "[", 
       RowBox[{"RR", "[", 
        RowBox[{"7", ",", "4", ",", "A", ",", "\[Omega]", ",", "\[Phi]"}], 
        "]"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{
        FractionBox["\[Omega]", 
         RowBox[{"2", "*", "\[Pi]"}]], 
        RowBox[{"Integrate", "[", 
         RowBox[{
          RowBox[{"HTilde", "[", 
           RowBox[{
           "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "tt", ",", 
            "\[Phi]"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"tt", ",", " ", "0", ",", " ", 
            FractionBox[
             RowBox[{"2", "*", "\[Pi]"}], "\[Omega]"]}], "}"}]}], "]"}]}], 
       ")"}], ".", 
      RowBox[{"RR", "[", 
       RowBox[{"7", ",", "4", ",", "A", ",", "\[Omega]", ",", "\[Phi]"}], 
       "]"}]}], ",", " ", 
     RowBox[{"Assumptions", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"A", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
       RowBox[{
        FractionBox["1", "\[Omega]"], "\[Element]", " ", "Reals"}], " ", "&&",
        " ", 
       RowBox[{"\[Omega]", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
       RowBox[{"\[Phi]", " ", "\[Element]", " ", "Reals"}]}]}]}], "]"}], " ", 
   "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.8323430900792494`*^9, 3.8323432053203163`*^9}, {
  3.832343252862395*^9, 3.8323432773867846`*^9}, {3.8323442243756585`*^9, 
  3.8323442468102655`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"c709b692-dff1-4456-9d74-e17d95715fd1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", 
       RowBox[{"BesselJ", "[", 
        RowBox[{"0", ",", 
         FractionBox["A", "\[Omega]"]}], "]"}]}], "0", 
      RowBox[{"-", "1"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "1"}], "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8323432431675243`*^9, 3.832343284255517*^9, 
  3.832344253723432*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"66d8ae7c-7ba0-4905-ae61-\
5024a3809fe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"IntegrateHTilde2", "[", 
    RowBox[{
    "Nl_", ",", " ", "centre_", ",", " ", "A_", ",", " ", "\[Omega]_", ",", 
     " ", "\[Phi]_", ",", " ", "tf_", ",", " ", "tvar_"}], "]"}], ":=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"HTilde2", "[", 
        RowBox[{
        "Nl", ",", " ", "centre", ",", " ", "A", ",", " ", "\[Omega]", ",", 
         " ", "tvar", ",", " ", "\[Phi]"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"tvar", ",", " ", "0", ",", " ", "tf"}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"A", " ", "\[Element]", " ", "Reals"}], "  ", "&&", " ", 
       RowBox[{"\[Omega]", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
       RowBox[{"\[Phi]", " ", "\[Element]", " ", "Reals"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"IntegrateHTilde2", "[", 
     RowBox[{
     "7", ",", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", "\[Phi]", 
      ",", " ", "t", ",", " ", "tt"}], "]"}], ",", " ", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{
      RowBox[{"A", " ", "\[Element]", " ", "Reals"}], "  ", "&&", " ", 
      RowBox[{"\[Omega]", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
      RowBox[{"\[Phi]", " ", "\[Element]", " ", "Reals"}], "&&", " ", 
      RowBox[{"tf", " ", "\[Element]", " ", "Reals"}]}]}]}], "]"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.831209745490835*^9, 3.8312098187485833`*^9}, {
   3.831209902205499*^9, 3.8312099047910256`*^9}, {3.8312102295172787`*^9, 
   3.8312102875727882`*^9}, {3.8312103550069456`*^9, 
   3.8312104072048717`*^9}, {3.8314795758495617`*^9, 3.831479576875867*^9}, 
   3.8314796232633376`*^9, {3.831479659403073*^9, 3.8314796602325945`*^9}, {
   3.8314796981563206`*^9, 3.831479703154298*^9}, {3.8314797608019695`*^9, 
   3.8314797899775105`*^9}, {3.831530983306939*^9, 3.8315309866907735`*^9}, {
   3.8315310202002215`*^9, 3.831531021861703*^9}, {3.8321692537837353`*^9, 
   3.832169273527357*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"ffb887e6-d190-41ea-a75b-046357f65697"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "t"}], "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "t"}], "0", 
      RowBox[{"-", "t"}], "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "t"}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "A", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]", "+", 
               RowBox[{"tt", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], 
        RowBox[{"\[DifferentialD]", "tt"}]}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"tt", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
        RowBox[{"\[DifferentialD]", "tt"}]}]}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"\[ImaginaryI]", " ", "A", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]", "+", 
              RowBox[{"tt", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
        RowBox[{"\[DifferentialD]", "tt"}]}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "t"], 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[ImaginaryI]", " ", "A", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Phi]", "+", 
               RowBox[{"tt", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]]}], 
        RowBox[{"\[DifferentialD]", "tt"}]}]}], "0", 
      RowBox[{"-", "t"}], "0"},
     {"0", "0", "0", "0", 
      RowBox[{"-", "t"}], "0", 
      RowBox[{"-", "t"}]},
     {"0", "0", "0", "0", "0", 
      RowBox[{"-", "t"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.831209825928445*^9, 3.83120991289634*^9, 3.8312102662950687`*^9, 
   3.8312102964346976`*^9, 3.831210398293976*^9, 3.8312104478634243`*^9, 
   3.8314668049329643`*^9, 3.83147959988125*^9, {3.831479778285514*^9, 
   3.831479797291433*^9}, 3.831531012240209*^9, 3.8315310464334583`*^9, 
   3.832169297839328*^9, 3.832169496351919*^9},
 CellLabel->
  "Out[4]//MatrixForm=",ExpressionUUID->"40ef1929-ee84-4b77-b24c-\
3b5dcec887ad"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"So", " ", "the", " ", "above", " ", "is", " ", "T", "*", "G"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.831209977303209*^9, 3.8312099864999247`*^9}, {
  3.8321692988357825`*^9, 3.83216932509462*^9}, {3.832169367030451*^9, 
  3.832169367742054*^9}},ExpressionUUID->"b1fbfb0d-503d-42fb-9705-\
1f2e789184b9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "second", " ", "term", " ", "of", " ", "the", " ", "Magnus", 
    " ", "Expansion"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CommutatorCalc", "[", 
      RowBox[{"A_", ",", " ", "B_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"A", ".", "B"}], "-", 
      RowBox[{"B", ".", "A"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"CommutatorCalc", "[", 
       RowBox[{
        RowBox[{"IntegrateHTilde2", "[", 
         RowBox[{
         "7", ",", "4", ",", " ", "A", ",", " ", "\[Omega]", ",", " ", 
          "\[Phi]", ",", " ", "t1", ",", " ", "t2"}], "]"}], ",", " ", 
        RowBox[{"HTilde2", "[", 
         RowBox[{
         "7", ",", "4", ",", "A", ",", "\[Omega]", ",", "t1", ",", " ", 
          "\[Phi]"}], "]"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"t1", ",", " ", "0", ",", " ", 
        FractionBox[
         RowBox[{"2", "*", "\[Pi]"}], "\[Omega]"]}], "}"}]}], "]"}], " ", "//",
     "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.832169089671301*^9, 3.8321690985861626`*^9}, {
  3.8321692242477407`*^9, 3.832169229145918*^9}, {3.8321693395263023`*^9, 
  3.832169339743177*^9}, {3.8321693827583866`*^9, 3.8321693852859297`*^9}, {
  3.8321695247425704`*^9, 3.83216959445438*^9}, {3.832169659214057*^9, 
  3.832169690817845*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cc264918-2e85-457e-9001-40e097c4f850"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", "t1"}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "t1"], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                "\[Omega]"]}]]}], 
            RowBox[{"\[DifferentialD]", "t2"}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", "0", "0"},
     {"0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]", "+", 
                    RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                 "\[Omega]"]}]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]", "+", 
                    RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                 "\[Omega]"]}]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", "0"},
     {"0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", "t1"}], "-", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "t1"], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]", "+", 
                  RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
            RowBox[{"\[DifferentialD]", "t2"}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"\[ImaginaryI]", " ", "A", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]", "+", 
                RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]], " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]", "+", 
                    RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                 "\[Omega]"]}]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", "t1"}], "-", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "t1"], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"\[Phi]", "+", 
                  RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
            RowBox[{"\[DifferentialD]", "t2"}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0"},
     {"0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]", "+", 
                    RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                 "\[Omega]"]}]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["\[ExponentialE]", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                  RowBox[{"Sin", "[", 
                   RowBox[{"\[Phi]", "+", 
                    RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                 "\[Omega]"]}]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", 
           RowBox[{
            SubsuperscriptBox["\[Integral]", "0", "t1"], 
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["\[ExponentialE]", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]]}], 
             RowBox[{"\[DifferentialD]", "t2"}]}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]"}], "\[Omega]"]], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"\[ImaginaryI]", " ", "A", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Phi]", "+", 
                 RowBox[{"t1", " ", "\[Omega]"}]}], "]"}]}], "\[Omega]"]}]], 
           " ", "t1"}], "+", 
          RowBox[{
           SubsuperscriptBox["\[Integral]", "0", "t1"], 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"\[ImaginaryI]", " ", "A", " ", 
                 RowBox[{"Sin", "[", 
                  RowBox[{"\[Phi]", "+", 
                   RowBox[{"t2", " ", "\[Omega]"}]}], "]"}]}], 
                "\[Omega]"]}]]}], 
            RowBox[{"\[DifferentialD]", "t2"}]}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "t1"}]}]}], "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8321693924128227`*^9, {3.832169518905921*^9, 3.832169539885829*^9}, 
   3.832169610144337*^9, 3.8321698792552414`*^9},
 CellLabel->
  "Out[12]//MatrixForm=",ExpressionUUID->"0758ce04-82d3-469f-92e4-\
da585b29a87a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{"\[ImaginaryI]", "*", "A", "*", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Omega]", "*", "tt"}], " ", "+", " ", "\[Phi]"}], "]"}], 
        "/", "\[Omega]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"tt", ",", " ", "0", ",", " ", 
       RowBox[{"2", "*", 
        RowBox[{"\[Pi]", "/", "\[Omega]"}]}]}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"Assumptions", "->", 
    RowBox[{
     RowBox[{"A", " ", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{"\[Omega]", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{"\[Phi]", "\[Element]", "Reals"}], " ", "&&", " ", 
     RowBox[{"t", " ", "\[Element]", " ", "Reals"}], " ", "&&", " ", 
     RowBox[{
      RowBox[{"A", "/", "\[Omega]"}], " ", "\[Element]", " ", "Reals"}]}]}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.8315322417308517`*^9, 3.831532295563825*^9}, {
  3.8315323373087664`*^9, 3.8315323793315473`*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"45a99a4e-d1b0-403d-8d3f-8abadf1ae815"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]", " ", 
   RowBox[{"BesselJ", "[", 
    RowBox[{"0", ",", 
     FractionBox["A", "\[Omega]"]}], "]"}]}], "\[Omega]"]], "Output",
 CellChangeTimes->{
  3.8315322981973076`*^9, {3.8315323626521597`*^9, 3.831532381598241*^9}},
 CellLabel->
  "Out[143]=",ExpressionUUID->"3440b3a7-9fb2-40b2-830f-5b7770e3b72c"]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2523, 66, 124, "Input",ExpressionUUID->"9fd9db2e-4768-423d-8417-d2e06e841bcb"],
Cell[3106, 90, 1238, 32, 147, "Output",ExpressionUUID->"4fa16113-f72f-4a25-bba7-aab7fc1933c4"],
Cell[4347, 124, 1502, 44, 147, "Output",ExpressionUUID->"f4b7fdaa-2982-4dcd-9f88-e6f7c248ecf5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5886, 173, 1080, 27, 48, "Input",ExpressionUUID->"dfe7f672-3734-4649-ba56-d5c86249c702"],
Cell[6969, 202, 1421, 38, 161, "Output",ExpressionUUID->"15cc3554-093c-466c-8518-15871ae33556"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8427, 245, 2477, 59, 86, "Input",ExpressionUUID->"27f3079f-ecb2-4494-98f4-178f8a6698ab"],
Cell[10907, 306, 2933, 83, 189, "Output",ExpressionUUID->"83ff7c92-8933-4782-ba3c-cee938e9aecf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13877, 394, 3372, 82, 95, "Input",ExpressionUUID->"a5a770f8-1436-40e5-919a-de0d2be7be19"],
Cell[17252, 478, 2984, 86, 189, "Output",ExpressionUUID->"ad07f0a9-b429-4028-87bd-b11747450dc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20273, 569, 1243, 32, 72, "Input",ExpressionUUID->"e76434d2-83af-434c-87d6-a511344c5bd7"],
Cell[21519, 603, 2452, 70, 210, "Output",ExpressionUUID->"c2d729ab-6663-4076-9c61-4d096a60c4df"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24008, 678, 2346, 62, 75, "Input",ExpressionUUID->"907d569a-d297-4cf2-910e-8f843dafcd1c"],
Cell[26357, 742, 2584, 73, 210, "Output",ExpressionUUID->"5dfd895f-e139-48c8-8b15-c6e2c7e56bd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28978, 820, 1156, 32, 93, "Input",ExpressionUUID->"4d23c2f0-7619-4258-9f9c-83488203b932"],
Cell[30137, 854, 1115, 28, 147, "Output",ExpressionUUID->"36ad0fd5-35c1-4d12-9a24-4cdbdf9ed170"],
Cell[31255, 884, 606, 17, 206, "Output",ExpressionUUID->"489f7d94-ea94-415e-9ed7-b354679bb95e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31898, 906, 1640, 39, 75, "Input",ExpressionUUID->"27d34c60-695d-43f6-b524-59611c241aa0"],
Cell[33541, 947, 1435, 36, 161, "Output",ExpressionUUID->"2b64dd2b-2cf3-4b51-930c-d158145a8cea"]
}, Open  ]],
Cell[34991, 986, 163, 3, 28, "Input",ExpressionUUID->"f06cd6d5-5da8-4f1f-9ed9-5e183c769fbd"],
Cell[CellGroupData[{
Cell[35179, 993, 1706, 39, 48, "Input",ExpressionUUID->"e3df5b7b-1d80-47af-bc1a-c7893c5d51be"],
Cell[36888, 1034, 2574, 69, 189, "Output",ExpressionUUID->"7baca02c-1b3f-4b0c-b042-b1057dee9700"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39499, 1108, 2732, 69, 95, "Input",ExpressionUUID->"25e7161e-70d6-4680-a44b-9b2c9cf7ef5e"],
Cell[42234, 1179, 2522, 70, 189, "Output",ExpressionUUID->"6c6a6560-8478-4961-8c27-16cab1197fad"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44793, 1254, 1212, 31, 72, "Input",ExpressionUUID->"eba8695d-a293-4b88-925d-28a1601b1ef3"],
Cell[46008, 1287, 1608, 49, 186, "Output",ExpressionUUID->"9c286a5e-1b60-4b63-98d6-6a64e3c6c079"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47653, 1341, 2202, 58, 112, "Input",ExpressionUUID->"fa72ba26-e5e2-4727-906e-b4e9b4157d10"],
Cell[49858, 1401, 1683, 50, 186, "Output",ExpressionUUID->"05a99f74-1b52-4eaf-be96-3e0a1e76d9ff"],
Cell[51544, 1453, 620, 16, 206, "Output",ExpressionUUID->"3727dda5-39df-469f-9d57-cc4799dcd3dc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52201, 1474, 1899, 46, 73, "Input",ExpressionUUID->"c709b692-dff1-4456-9d74-e17d95715fd1"],
Cell[54103, 1522, 1605, 49, 186, "Output",ExpressionUUID->"66d8ae7c-7ba0-4905-ae61-5024a3809fe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55745, 1576, 2240, 47, 48, "Input",ExpressionUUID->"ffb887e6-d190-41ea-a75b-046357f65697"],
Cell[57988, 1625, 3187, 85, 201, "Output",ExpressionUUID->"40ef1929-ee84-4b77-b24c-3b5dcec887ad"]
}, Open  ]],
Cell[61190, 1713, 349, 7, 28, "Input",ExpressionUUID->"b1fbfb0d-503d-42fb-9705-1f2e789184b9"],
Cell[CellGroupData[{
Cell[61564, 1724, 1521, 37, 91, "Input",ExpressionUUID->"cc264918-2e85-457e-9001-40e097c4f850"],
Cell[63088, 1763, 15120, 392, 277, "Output",ExpressionUUID->"0758ce04-82d3-469f-92e4-da585b29a87a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78245, 2160, 1155, 28, 28, "Input",ExpressionUUID->"45a99a4e-d1b0-403d-8d3f-8abadf1ae815"],
Cell[79403, 2190, 361, 9, 68, "Output",ExpressionUUID->"3440b3a7-9fb2-40b2-830f-5b7770e3b72c"]
}, Open  ]]
}
]
*)

